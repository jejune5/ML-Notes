```html
<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>
```

# CH6 循环神经网络

## 6.1 给网络增加记忆能力

延时网络
$$
\boldsymbol{h}_{t}^{(l)}=f\left(\boldsymbol{h}_{t}^{(l-1)}, \boldsymbol{h}_{t-1}^{(l-1)}, \cdots, \boldsymbol{h}_{t-K}^{(l-1)}\right)
$$

## 6.4 参数学习

对数据集，***x1***为输入，*y1*为标签（长度均为T）：
$$
\boldsymbol{x}_{1: T}=\left(\boldsymbol{x}_{1}, \cdots, \boldsymbol{x}_{T}\right)
$$

$$
y_{1: T}=\left(y_{1}, \cdots, y_{T}\right)
$$

*t* 时刻损失函数:
$$
\mathcal{L}_{t}=\mathcal{L}\left(y_{t}, g\left(\boldsymbol{h}_{t}\right)\right)
$$
对参数 U 求梯度：
$$
\frac{\partial \mathcal{L}}{\partial \boldsymbol{U}}=\sum_{t=1}^{T} \frac{\partial \mathcal{L}_{t}}{\partial \boldsymbol{U}}
$$

### 6.4.1 随时间反向传播（BPTT）

计算偏导数：
$$
\frac{\partial \mathcal{L}_{t}}{\partial \boldsymbol{U}}
$$

### 6.4.2 实时循环学习（RTRL）

123